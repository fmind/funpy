<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>funpy.pp API documentation</title>
    <meta name="description" content="Parallel library" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">
    <li class="set"><h3><a href="#header-variables">Module variables</a></h3>
      
  <ul>
    <li class="mono"><a href="#funpy.pp.Pool">Pool</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
    <li class="mono"><a href="#funpy.pp.mapreduce">mapreduce</a></li>
    <li class="mono"><a href="#funpy.pp.pmap">pmap</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#funpy.pp.ProcessPoolExecutor">ProcessPool</a></span>
        
          
  <ul>
    <li class="mono"><a href="#funpy.pp.ProcessPoolExecutor.__init__">__init__</a></li>
    <li class="mono"><a href="#funpy.pp.ProcessPoolExecutor.map">map</a></li>
    <li class="mono"><a href="#funpy.pp.ProcessPoolExecutor.shutdown">shutdown</a></li>
    <li class="mono"><a href="#funpy.pp.ProcessPoolExecutor.submit">submit</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#funpy.pp.ThreadPoolExecutor">ThreadPool</a></span>
        
          
  <ul>
    <li class="mono"><a href="#funpy.pp.ThreadPoolExecutor.__init__">__init__</a></li>
    <li class="mono"><a href="#funpy.pp.ThreadPoolExecutor.map">map</a></li>
    <li class="mono"><a href="#funpy.pp.ThreadPoolExecutor.shutdown">shutdown</a></li>
    <li class="mono"><a href="#funpy.pp.ThreadPoolExecutor.submit">submit</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">funpy.pp</span> module</h1>
  <p>Parallel library</p>
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp" class="source">
    <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;Parallel library&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Type</span>

<span class="kn">from</span> <span class="nn">funpy</span> <span class="kn">import</span> <span class="n">it</span>

<span class="c1"># TYPES {{{</span>

<span class="n">Pool</span> <span class="o">=</span> <span class="n">Type</span><span class="p">[</span><span class="n">futures</span><span class="o">.</span><span class="n">Executor</span><span class="p">]</span>

<span class="n">ThreadPool</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span>

<span class="n">ProcessPool</span> <span class="o">=</span> <span class="n">futures</span><span class="o">.</span><span class="n">ProcessPoolExecutor</span>
<span class="c1"># }}}</span>
<span class="c1"># PARALLELS {{{</span>
<span class="k">def</span> <span class="nf">pmap</span><span class="p">(</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">ls</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Pool</span> <span class="o">=</span> <span class="n">ProcessPool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parallel implementation of map (ordered).</span>

<span class="sd">    &gt;&gt;&gt; list(pmap(pow, range(1, 5), range(1, 6), pool=ThreadPool))</span>
<span class="sd">    [1, 4, 27, 256]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pool</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">yield from</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">ls</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mapreduce</span><span class="p">(</span>
    <span class="n">mapper</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">ls</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Pool</span> <span class="o">=</span> <span class="n">ProcessPool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parallel implement of map reduce.</span>

<span class="sd">    &gt;&gt;&gt; def mapper(x): return x % 2, x</span>
<span class="sd">    &gt;&gt;&gt; def reducer(xs): return sum(xs)</span>
<span class="sd">    &gt;&gt;&gt; list(mapreduce(mapper, reducer, range(5), pool=ThreadPool))</span>
<span class="sd">    [(0, 6), (1, 4)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pool</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="n">mapped</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="o">*</span><span class="n">ls</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>

        <span class="n">grouped</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">groupkv</span><span class="p">(</span><span class="n">mapped</span><span class="p">)</span>

        <span class="n">reduced</span> <span class="o">=</span> <span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">)</span>

        <span class="k">yield from</span> <span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">reduced</span><span class="p">)</span>


<span class="c1"># }}}</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">
    <h2 class="section-title" id="header-variables">Module variables</h2>
      <div class="item">
      <p id="funpy.pp.Pool" class="name">var <span class="ident">Pool</span></p>
      
  
  <div class="source_cont">
</div>

      </div>

    <h2 class="section-title" id="header-functions">Functions</h2>
      
  <div class="item">
    <div class="name def" id="funpy.pp.mapreduce">
    <p>def <span class="ident">mapreduce</span>(</p><p>mapper, reducer, *ls)</p>
    </div>
    

    
  
    <div class="desc"><p>Parallel implement of map reduce.</p>
<blockquote>
<blockquote>
<blockquote>
<p>def mapper(x): return x % 2, x
def reducer(xs): return sum(xs)
list(mapreduce(mapper, reducer, range(5), pool=ThreadPool))
[(0, 6), (1, 4)]</p>
</blockquote>
</blockquote>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.mapreduce', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.mapreduce" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">mapreduce</span><span class="p">(</span>
    <span class="n">mapper</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="n">reducer</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">ls</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Pool</span> <span class="o">=</span> <span class="n">ProcessPool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parallel implement of map reduce.</span>

<span class="sd">    &gt;&gt;&gt; def mapper(x): return x % 2, x</span>
<span class="sd">    &gt;&gt;&gt; def reducer(xs): return sum(xs)</span>
<span class="sd">    &gt;&gt;&gt; list(mapreduce(mapper, reducer, range(5), pool=ThreadPool))</span>
<span class="sd">    [(0, 6), (1, 4)]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pool</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="n">mapped</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapper</span><span class="p">,</span> <span class="o">*</span><span class="n">ls</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>

        <span class="n">grouped</span> <span class="o">=</span> <span class="n">it</span><span class="o">.</span><span class="n">groupkv</span><span class="p">(</span><span class="n">mapped</span><span class="p">)</span>

        <span class="n">reduced</span> <span class="o">=</span> <span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">grouped</span><span class="p">)</span>

        <span class="k">yield from</span> <span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">))</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">reduced</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="funpy.pp.pmap">
    <p>def <span class="ident">pmap</span>(</p><p>f, *ls)</p>
    </div>
    

    
  
    <div class="desc"><p>Parallel implementation of map (ordered).</p>
<blockquote>
<blockquote>
<blockquote>
<p>list(pmap(pow, range(1, 5), range(1, 6), pool=ThreadPool))
[1, 4, 27, 256]</p>
</blockquote>
</blockquote>
</blockquote></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.pmap', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.pmap" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">pmap</span><span class="p">(</span>
    <span class="n">f</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span>
    <span class="o">*</span><span class="n">ls</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">,</span>
    <span class="n">workers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span>
    <span class="n">chunksize</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">pool</span><span class="p">:</span> <span class="n">Pool</span> <span class="o">=</span> <span class="n">ProcessPool</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Parallel implementation of map (ordered).</span>

<span class="sd">    &gt;&gt;&gt; list(pmap(pow, range(1, 5), range(1, 6), pool=ThreadPool))</span>
<span class="sd">    [1, 4, 27, 256]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">pool</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">p</span><span class="p">:</span>  <span class="c1"># type: ignore</span>
        <span class="k">yield from</span> <span class="n">p</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">ls</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="funpy.pp.ProcessPoolExecutor" class="name">class <span class="ident">ProcessPool</span></p>
      
  
    <div class="desc"><p>This is an abstract base class for concrete asynchronous executors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ProcessPoolExecutor', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ProcessPoolExecutor" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ProcessPoolExecutor</span><span class="p">(</span><span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
                 <span class="n">initializer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;Initializes a new ProcessPoolExecutor instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            max_workers: The maximum number of processes that can be used to</span>
<span class="sd">                execute the given calls. If None or not given then as many</span>
<span class="sd">                worker processes will be created as the machine has processors.</span>
<span class="sd">            mp_context: A multiprocessing context to launch the workers. This</span>
<span class="sd">                object should provide SimpleQueue, Queue and Process.</span>
<span class="sd">            initializer: An callable used to initialize worker processes.</span>
<span class="sd">            initargs: A tuple of arguments to pass to the initializer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_check_system_limits</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">max_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_workers must be greater than 0&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">max_workers</span>

        <span class="k">if</span> <span class="n">mp_context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">mp_context</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mp_context</span> <span class="o">=</span> <span class="n">mp_context</span>

        <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">initializer</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;initializer must be a callable&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span> <span class="o">=</span> <span class="n">initializer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span> <span class="o">=</span> <span class="n">initargs</span>

        <span class="c1"># Management thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="c1"># Map of pids to processes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Shutdown is a two-step process.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Create communication channels for the executor</span>
        <span class="c1"># Make the call queue slightly larger than the number of processes to</span>
        <span class="c1"># prevent the worker processes from idling. But don&#39;t make it too big</span>
        <span class="c1"># because futures in the call queue cannot be cancelled.</span>
        <span class="n">queue_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">+</span> <span class="n">EXTRA_QUEUED_CALLS</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="o">=</span> <span class="n">_SafeQueue</span><span class="p">(</span>
            <span class="n">max_size</span><span class="o">=</span><span class="n">queue_size</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_mp_context</span><span class="p">,</span>
            <span class="n">pending_work_items</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span><span class="p">)</span>
        <span class="c1"># Killed worker processes can produce spurious &quot;broken pipe&quot;</span>
        <span class="c1"># tracebacks in the queue&#39;s own worker thread. But we detect killed</span>
        <span class="c1"># processes anyway, so silence the tracebacks.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">_ignore_epipe</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span> <span class="o">=</span> <span class="n">mp_context</span><span class="o">.</span><span class="n">SimpleQueue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_work_ids</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>

        <span class="c1"># _ThreadWakeup is a communication channel used to interrupt the wait</span>
        <span class="c1"># of the main loop of queue_manager_thread from another thread (e.g.</span>
        <span class="c1"># when calling executor.submit or executor.shutdown). We do not use the</span>
        <span class="c1"># _result_queue to send the wakeup signal to the queue_manager_thread</span>
        <span class="c1"># as it could result in a deadlock if a worker process dies with the</span>
        <span class="c1"># _result_queue write lock still acquired.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span> <span class="o">=</span> <span class="n">_ThreadWakeup</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_start_queue_management_thread</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># When the executor gets garbarge collected, the weakref callback</span>
            <span class="c1"># will wake up the queue management thread so that it can terminate</span>
            <span class="c1"># if there is no pending work item.</span>
            <span class="k">def</span> <span class="nf">weakref_cb</span><span class="p">(</span><span class="n">_</span><span class="p">,</span>
                           <span class="n">thread_wakeup</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="p">):</span>
                <span class="n">mp</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Executor collected: triggering callback for&#39;</span>
                              <span class="s1">&#39; QueueManager wakeup&#39;</span><span class="p">)</span>
                <span class="n">thread_wakeup</span><span class="o">.</span><span class="n">wakeup</span><span class="p">()</span>
            <span class="c1"># Start the processes so that their sentinels are known.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_process_count</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="n">_queue_management_worker</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weakref_cb</span><span class="p">),</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_work_ids</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="p">),</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;QueueManagerThread&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="n">_threads_wakeups</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="p">]</span> <span class="o">=</span> \
                <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span>

    <span class="k">def</span> <span class="nf">_adjust_process_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span><span class="p">):</span>
            <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_mp_context</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
                <span class="n">target</span><span class="o">=</span><span class="n">_process_worker</span><span class="p">,</span>
                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span><span class="p">,</span>
                      <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span><span class="p">))</span>
            <span class="n">p</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span><span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">pid</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>

    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">BrokenProcessPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after shutdown&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_global_shutdown</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after &#39;</span>
                                   <span class="s1">&#39;interpreter shutdown&#39;</span><span class="p">)</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">_WorkItem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_work_ids</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="c1"># Wake up queue management thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">wakeup</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_start_queue_management_thread</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">f</span>
    <span class="n">submit</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="o">.</span><span class="n">submit</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns an iterator equivalent to map(fn, iter).</span>

<span class="sd">        Args:</span>
<span class="sd">            fn: A callable that will take as many arguments as there are</span>
<span class="sd">                passed iterables.</span>
<span class="sd">            timeout: The maximum number of seconds to wait. If None, then there</span>
<span class="sd">                is no limit on the wait time.</span>
<span class="sd">            chunksize: If greater than one, the iterables will be chopped into</span>
<span class="sd">                chunks of size chunksize and submitted to the process pool.</span>
<span class="sd">                If set to one, the items in the list will be sent one at a time.</span>

<span class="sd">        Returns:</span>
<span class="sd">            An iterator equivalent to: map(func, *iterables) but the calls may</span>
<span class="sd">            be evaluated out-of-order.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TimeoutError: If the entire result iterator could not be generated</span>
<span class="sd">                before the given timeout.</span>
<span class="sd">            Exception: If fn(*args) raises for any values.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">chunksize</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;chunksize must be &gt;= 1.&quot;</span><span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">_process_chunk</span><span class="p">,</span> <span class="n">fn</span><span class="p">),</span>
                              <span class="n">_get_chunks</span><span class="p">(</span><span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">),</span>
                              <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_chain_from_iterable_of_lists</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="p">:</span>
            <span class="c1"># Wake up queue management thread</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">wakeup</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
        <span class="c1"># To reduce the risk of opening too many files, remove references to</span>
        <span class="c1"># objects that use file descriptors.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">join_thread</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="bp">None</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span> <span class="o">=</span> <span class="bp">None</span>

    <span class="n">shutdown</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="vm">__doc__</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#funpy.pp.ProcessPoolExecutor">ProcessPool</a></li>
          <li>concurrent.futures._base.Executor</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="funpy.pp.ProcessPoolExecutor.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, max_workers=None, mp_context=None, initializer=None, initargs=())</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes a new ProcessPoolExecutor instance.</p>
<p>Args:
    max_workers: The maximum number of processes that can be used to
        execute the given calls. If None or not given then as many
        worker processes will be created as the machine has processors.
    mp_context: A multiprocessing context to launch the workers. This
        object should provide SimpleQueue, Queue and Process.
    initializer: An callable used to initialize worker processes.
    initargs: A tuple of arguments to pass to the initializer.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ProcessPoolExecutor.__init__', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ProcessPoolExecutor.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">mp_context</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
             <span class="n">initializer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;Initializes a new ProcessPoolExecutor instance.</span>
<span class="sd">    Args:</span>
<span class="sd">        max_workers: The maximum number of processes that can be used to</span>
<span class="sd">            execute the given calls. If None or not given then as many</span>
<span class="sd">            worker processes will be created as the machine has processors.</span>
<span class="sd">        mp_context: A multiprocessing context to launch the workers. This</span>
<span class="sd">            object should provide SimpleQueue, Queue and Process.</span>
<span class="sd">        initializer: An callable used to initialize worker processes.</span>
<span class="sd">        initargs: A tuple of arguments to pass to the initializer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_check_system_limits</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">max_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_workers must be greater than 0&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">max_workers</span>
    <span class="k">if</span> <span class="n">mp_context</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">mp_context</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">get_context</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_mp_context</span> <span class="o">=</span> <span class="n">mp_context</span>
    <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">initializer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;initializer must be a callable&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span> <span class="o">=</span> <span class="n">initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span> <span class="o">=</span> <span class="n">initargs</span>
    <span class="c1"># Management thread</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="c1"># Map of pids to processes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Shutdown is a two-step process.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="c1"># Create communication channels for the executor</span>
    <span class="c1"># Make the call queue slightly larger than the number of processes to</span>
    <span class="c1"># prevent the worker processes from idling. But don&#39;t make it too big</span>
    <span class="c1"># because futures in the call queue cannot be cancelled.</span>
    <span class="n">queue_size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">+</span> <span class="n">EXTRA_QUEUED_CALLS</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="o">=</span> <span class="n">_SafeQueue</span><span class="p">(</span>
        <span class="n">max_size</span><span class="o">=</span><span class="n">queue_size</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_mp_context</span><span class="p">,</span>
        <span class="n">pending_work_items</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span><span class="p">)</span>
    <span class="c1"># Killed worker processes can produce spurious &quot;broken pipe&quot;</span>
    <span class="c1"># tracebacks in the queue&#39;s own worker thread. But we detect killed</span>
    <span class="c1"># processes anyway, so silence the tracebacks.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">_ignore_epipe</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span> <span class="o">=</span> <span class="n">mp_context</span><span class="o">.</span><span class="n">SimpleQueue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_work_ids</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
    <span class="c1"># _ThreadWakeup is a communication channel used to interrupt the wait</span>
    <span class="c1"># of the main loop of queue_manager_thread from another thread (e.g.</span>
    <span class="c1"># when calling executor.submit or executor.shutdown). We do not use the</span>
    <span class="c1"># _result_queue to send the wakeup signal to the queue_manager_thread</span>
    <span class="c1"># as it could result in a deadlock if a worker process dies with the</span>
    <span class="c1"># _result_queue write lock still acquired.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span> <span class="o">=</span> <span class="n">_ThreadWakeup</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ProcessPoolExecutor.map">
    <p>def <span class="ident">map</span>(</p><p>self, fn, *iterables)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns an iterator equivalent to map(fn, iter).</p>
<p>Args:
    fn: A callable that will take as many arguments as there are
        passed iterables.
    timeout: The maximum number of seconds to wait. If None, then there
        is no limit on the wait time.
    chunksize: If greater than one, the iterables will be chopped into
        chunks of size chunksize and submitted to the process pool.
        If set to one, the items in the list will be sent one at a time.</p>
<p>Returns:
    An iterator equivalent to: map(func, *iterables) but the calls may
    be evaluated out-of-order.</p>
<p>Raises:
    TimeoutError: If the entire result iterator could not be generated
        before the given timeout.
    Exception: If fn(*args) raises for any values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ProcessPoolExecutor.map', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ProcessPoolExecutor.map" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an iterator equivalent to map(fn, iter).</span>
<span class="sd">    Args:</span>
<span class="sd">        fn: A callable that will take as many arguments as there are</span>
<span class="sd">            passed iterables.</span>
<span class="sd">        timeout: The maximum number of seconds to wait. If None, then there</span>
<span class="sd">            is no limit on the wait time.</span>
<span class="sd">        chunksize: If greater than one, the iterables will be chopped into</span>
<span class="sd">            chunks of size chunksize and submitted to the process pool.</span>
<span class="sd">            If set to one, the items in the list will be sent one at a time.</span>
<span class="sd">    Returns:</span>
<span class="sd">        An iterator equivalent to: map(func, *iterables) but the calls may</span>
<span class="sd">        be evaluated out-of-order.</span>
<span class="sd">    Raises:</span>
<span class="sd">        TimeoutError: If the entire result iterator could not be generated</span>
<span class="sd">            before the given timeout.</span>
<span class="sd">        Exception: If fn(*args) raises for any values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">chunksize</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;chunksize must be &gt;= 1.&quot;</span><span class="p">)</span>
    <span class="n">results</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">_process_chunk</span><span class="p">,</span> <span class="n">fn</span><span class="p">),</span>
                          <span class="n">_get_chunks</span><span class="p">(</span><span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">),</span>
                          <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_chain_from_iterable_of_lists</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ProcessPoolExecutor.shutdown">
    <p>def <span class="ident">shutdown</span>(</p><p>self, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Clean-up the resources associated with the Executor.</p>
<p>It is safe to call this method several times. Otherwise, no other
methods can be called after this one.</p>
<p>Args:
    wait: If True then shutdown will not return until all running
        futures have finished executing and the resources used by the
        executor have been reclaimed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ProcessPoolExecutor.shutdown', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ProcessPoolExecutor.shutdown" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="p">:</span>
        <span class="c1"># Wake up queue management thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">wakeup</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="c1"># To reduce the risk of opening too many files, remove references to</span>
    <span class="c1"># objects that use file descriptors.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span><span class="o">.</span><span class="n">join_thread</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_call_queue</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_result_queue</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_processes</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ProcessPoolExecutor.submit">
    <p>def <span class="ident">submit</span>(</p><p>self, fn, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Submits a callable to be executed with the given arguments.</p>
<p>Schedules the callable to be executed as fn(<em>args, </em>*kwargs) and returns
a Future instance representing the execution of the callable.</p>
<p>Returns:
    A Future representing the given call.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ProcessPoolExecutor.submit', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ProcessPoolExecutor.submit" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BrokenProcessPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_thread</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after shutdown&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_global_shutdown</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after &#39;</span>
                               <span class="s1">&#39;interpreter shutdown&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_WorkItem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pending_work_items</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span><span class="p">]</span> <span class="o">=</span> <span class="n">w</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_work_ids</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Wake up queue management thread</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_queue_management_thread_wakeup</span><span class="o">.</span><span class="n">wakeup</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_start_queue_management_thread</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>
      
      <div class="item">
      <p id="funpy.pp.ThreadPoolExecutor" class="name">class <span class="ident">ThreadPool</span></p>
      
  
    <div class="desc"><p>This is an abstract base class for concrete asynchronous executors.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ThreadPoolExecutor', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ThreadPoolExecutor" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">ThreadPoolExecutor</span><span class="p">(</span><span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="p">):</span>

    <span class="c1"># Used to assign unique thread names when thread_name_prefix is not supplied.</span>
    <span class="n">_counter</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">__next__</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">thread_name_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                 <span class="n">initializer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">()):</span>
        <span class="sd">&quot;&quot;&quot;Initializes a new ThreadPoolExecutor instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            max_workers: The maximum number of threads that can be used to</span>
<span class="sd">                execute the given calls.</span>
<span class="sd">            thread_name_prefix: An optional name prefix to give our threads.</span>
<span class="sd">            initializer: An callable used to initialize worker threads.</span>
<span class="sd">            initargs: A tuple of arguments to pass to the initializer.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="c1"># Use this number because ThreadPoolExecutor is often</span>
            <span class="c1"># used to overlap I/O instead of CPU work.</span>
            <span class="n">max_workers</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">max_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_workers must be greater than 0&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">initializer</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;initializer must be a callable&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">max_workers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">SimpleQueue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_threads</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_thread_name_prefix</span> <span class="o">=</span> <span class="p">(</span><span class="n">thread_name_prefix</span> <span class="ow">or</span>
                                    <span class="p">(</span><span class="s2">&quot;ThreadPoolExecutor-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">()))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span> <span class="o">=</span> <span class="n">initializer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span> <span class="o">=</span> <span class="n">initargs</span>

    <span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">BrokenThreadPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after shutdown&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_shutdown</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after &#39;</span>
                                   <span class="s1">&#39;interpreter shutdown&#39;</span><span class="p">)</span>

            <span class="n">f</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">_WorkItem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_thread_count</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">f</span>
    <span class="n">submit</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="o">.</span><span class="n">submit</span><span class="o">.</span><span class="vm">__doc__</span>

    <span class="k">def</span> <span class="nf">_adjust_thread_count</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># When the executor gets lost, the weakref callback will wake up</span>
        <span class="c1"># the worker threads.</span>
        <span class="k">def</span> <span class="nf">weakref_cb</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="p">):</span>
            <span class="n">q</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="c1"># TODO(bquinlan): Should avoid creating new threads if there are more</span>
        <span class="c1"># idle threads than items in the work queue.</span>
        <span class="n">num_threads</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_threads</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">num_threads</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span><span class="p">:</span>
            <span class="n">thread_name</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">_</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_thread_name_prefix</span> <span class="ow">or</span> <span class="bp">self</span><span class="p">,</span>
                                     <span class="n">num_threads</span><span class="p">)</span>
            <span class="n">t</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">thread_name</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">_worker</span><span class="p">,</span>
                                 <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">weakref</span><span class="o">.</span><span class="n">ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">weakref_cb</span><span class="p">),</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span><span class="p">,</span>
                                       <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span><span class="p">))</span>
            <span class="n">t</span><span class="o">.</span><span class="n">daemon</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">t</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_threads</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
            <span class="n">_threads_queues</span><span class="p">[</span><span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span>

    <span class="k">def</span> <span class="nf">_initializer_failed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;A thread initializer failed, the thread pool &#39;</span>
                            <span class="s1">&#39;is not usable anymore&#39;</span><span class="p">)</span>
            <span class="c1"># Drain work queue and mark pending futures failed</span>
            <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">work_item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="o">.</span><span class="n">get_nowait</span><span class="p">()</span>
                <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">if</span> <span class="n">work_item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="n">work_item</span><span class="o">.</span><span class="n">future</span><span class="o">.</span><span class="n">set_exception</span><span class="p">(</span><span class="n">BrokenThreadPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_threads</span><span class="p">:</span>
                <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
    <span class="n">shutdown</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Executor</span><span class="o">.</span><span class="n">shutdown</span><span class="o">.</span><span class="vm">__doc__</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#funpy.pp.ThreadPoolExecutor">ThreadPool</a></li>
          <li>concurrent.futures._base.Executor</li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="funpy.pp.ThreadPoolExecutor.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, max_workers=None, thread_name_prefix=&#39;&#39;, initializer=None, initargs=())</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes a new ThreadPoolExecutor instance.</p>
<p>Args:
    max_workers: The maximum number of threads that can be used to
        execute the given calls.
    thread_name_prefix: An optional name prefix to give our threads.
    initializer: An callable used to initialize worker threads.
    initargs: A tuple of arguments to pass to the initializer.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ThreadPoolExecutor.__init__', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ThreadPoolExecutor.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">thread_name_prefix</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
             <span class="n">initializer</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">initargs</span><span class="o">=</span><span class="p">()):</span>
    <span class="sd">&quot;&quot;&quot;Initializes a new ThreadPoolExecutor instance.</span>
<span class="sd">    Args:</span>
<span class="sd">        max_workers: The maximum number of threads that can be used to</span>
<span class="sd">            execute the given calls.</span>
<span class="sd">        thread_name_prefix: An optional name prefix to give our threads.</span>
<span class="sd">        initializer: An callable used to initialize worker threads.</span>
<span class="sd">        initargs: A tuple of arguments to pass to the initializer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c1"># Use this number because ThreadPoolExecutor is often</span>
        <span class="c1"># used to overlap I/O instead of CPU work.</span>
        <span class="n">max_workers</span> <span class="o">=</span> <span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span>
    <span class="k">if</span> <span class="n">max_workers</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;max_workers must be greater than 0&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">initializer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="n">initializer</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;initializer must be a callable&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_max_workers</span> <span class="o">=</span> <span class="n">max_workers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">SimpleQueue</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_threads</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Lock</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_thread_name_prefix</span> <span class="o">=</span> <span class="p">(</span><span class="n">thread_name_prefix</span> <span class="ow">or</span>
                                <span class="p">(</span><span class="s2">&quot;ThreadPoolExecutor-</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">_counter</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initializer</span> <span class="o">=</span> <span class="n">initializer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_initargs</span> <span class="o">=</span> <span class="n">initargs</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ThreadPoolExecutor.map">
    <p>def <span class="ident">map</span>(</p><p>self, fn, *iterables)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns an iterator equivalent to map(fn, iter).</p>
<p>Args:
    fn: A callable that will take as many arguments as there are
        passed iterables.
    timeout: The maximum number of seconds to wait. If None, then there
        is no limit on the wait time.
    chunksize: The size of the chunks the iterable will be broken into
        before being passed to a child process. This argument is only
        used by ProcessPoolExecutor; it is ignored by
        ThreadPoolExecutor.</p>
<p>Returns:
    An iterator equivalent to: map(func, *iterables) but the calls may
    be evaluated out-of-order.</p>
<p>Raises:
    TimeoutError: If the entire result iterator could not be generated
        before the given timeout.
    Exception: If fn(*args) raises for any values.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ThreadPoolExecutor.map', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ThreadPoolExecutor.map" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">iterables</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns an iterator equivalent to map(fn, iter).</span>
<span class="sd">    Args:</span>
<span class="sd">        fn: A callable that will take as many arguments as there are</span>
<span class="sd">            passed iterables.</span>
<span class="sd">        timeout: The maximum number of seconds to wait. If None, then there</span>
<span class="sd">            is no limit on the wait time.</span>
<span class="sd">        chunksize: The size of the chunks the iterable will be broken into</span>
<span class="sd">            before being passed to a child process. This argument is only</span>
<span class="sd">            used by ProcessPoolExecutor; it is ignored by</span>
<span class="sd">            ThreadPoolExecutor.</span>
<span class="sd">    Returns:</span>
<span class="sd">        An iterator equivalent to: map(func, *iterables) but the calls may</span>
<span class="sd">        be evaluated out-of-order.</span>
<span class="sd">    Raises:</span>
<span class="sd">        TimeoutError: If the entire result iterator could not be generated</span>
<span class="sd">            before the given timeout.</span>
<span class="sd">        Exception: If fn(*args) raises for any values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">timeout</span> <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">()</span>
    <span class="n">fs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">submit</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span> <span class="k">for</span> <span class="n">args</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">iterables</span><span class="p">)]</span>
    <span class="c1"># Yield must be hidden in closure so that the futures are submitted</span>
    <span class="c1"># before the first iterator value is required.</span>
    <span class="k">def</span> <span class="nf">result_iterator</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># reverse to keep finishing order</span>
            <span class="n">fs</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
            <span class="k">while</span> <span class="n">fs</span><span class="p">:</span>
                <span class="c1"># Careful not to keep a reference to the popped future</span>
                <span class="k">if</span> <span class="n">timeout</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">fs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">result</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">fs</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">result</span><span class="p">(</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">time</span><span class="o">.</span><span class="n">monotonic</span><span class="p">())</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">future</span> <span class="ow">in</span> <span class="n">fs</span><span class="p">:</span>
                <span class="n">future</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">result_iterator</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ThreadPoolExecutor.shutdown">
    <p>def <span class="ident">shutdown</span>(</p><p>self, wait=True)</p>
    </div>
    

    
  
    <div class="desc"><p>Clean-up the resources associated with the Executor.</p>
<p>It is safe to call this method several times. Otherwise, no other
methods can be called after this one.</p>
<p>Args:
    wait: If True then shutdown will not return until all running
        futures have finished executing and the resources used by the
        executor have been reclaimed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ThreadPoolExecutor.shutdown', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ThreadPoolExecutor.shutdown" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">shutdown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wait</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">wait</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_threads</span><span class="p">:</span>
            <span class="n">t</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="funpy.pp.ThreadPoolExecutor.submit">
    <p>def <span class="ident">submit</span>(</p><p>self, fn, *args, **kwargs)</p>
    </div>
    

    
  
    <div class="desc"><p>Submits a callable to be executed with the given arguments.</p>
<p>Schedules the callable to be executed as fn(<em>args, </em>*kwargs) and returns
a Future instance representing the execution of the callable.</p>
<p>Returns:
    A Future representing the given call.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-funpy.pp.ThreadPoolExecutor.submit', this);">Show source &equiv;</a></p>
  <div id="source-funpy.pp.ThreadPoolExecutor.submit" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">submit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown_lock</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BrokenThreadPool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_broken</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shutdown</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after shutdown&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_shutdown</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot schedule new futures after &#39;</span>
                               <span class="s1">&#39;interpreter shutdown&#39;</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">_base</span><span class="o">.</span><span class="n">Future</span><span class="p">()</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">_WorkItem</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">fn</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_work_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_adjust_thread_count</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">f</span>
</pre></div>

  </div>
</div>

  </div>
  
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
